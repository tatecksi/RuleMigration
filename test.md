| No. 	| Type         	| Sample Detection Rule                       	| Sample KQL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      	| Reference      	|
|-----	|--------------	|---------------------------------------------	|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|----------------	|
| 1.   	| **Filter** (and) 	| <img src="media/caf5e11a5e0d7ed6dcc675c0caaaf7aa.png"> 	| <br><pre>SecurityEventSecurityEvent<br>\| where EventID == 4728<br>\| where SubjectUserName =~ "AutoMatedService"<br>\| where isnotempty(SubjectDomainName)</pre><sub> *This assumes that the Windows Security Events are collected via MMA/AMA. Hence, we are using SecurityEvent table in Azure Sentinel.*<br><br>**Note:** <br> - Avoid case-insensitive operators (=~) when possible for query optimization. <br> - Use (==) if the value is not case-sensitive.<br> - Order the filters by starting with the 'where' statement that filter out the most data.</sub> | <sub> [String Operators](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datatypes-string-operators#operators-on-strings)<br/>[Numerical Operators](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/numoperators)<br/>[ago](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/agofunction)<br/>[Datetime/timespan arithmetric](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datetime-timespan-arithmetic)<br/>[between](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/betweenoperator)<br/>[now](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/nowfunction)<br/> [parse](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parseoperator)<br/>[extract](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/extractfunction)<br/>[parse_json](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsejsonfunction)<br/>[parse_csv](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsecsvfunction)<br/>[parse_path](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsepathfunction)<br/>[parse_url](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parseurlfunction) </sub>	|
| 2.   |   **Filter** (or)   | <img src="media/cf7c4ef2bf29e136988353de1355bec2.png">  |**Option 1: Use 'in'**<br><br><pre>SecurityEvent<br>\| where SubjectUserName in ("Adm1","ServiceAccount1","AutomationServices")</pre><br>**Option 2: Use 'or'**<br><br><pre>SecurityEvent<br>\| where SubjectUserName == "Adm1" or SubjectUserName == "ServiceAccount1" or SubjectUserName == "AutomationServices"</pre> | <sub> [String Operators](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datatypes-string-operators#operators-on-strings)<br/>[in](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/inoperator) </sub> |
