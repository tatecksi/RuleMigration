| No. | Type | Sample Detection Rule | Sample KQL | Reference |
|---|---|---|---|---|
| 1.  | **Filter** (and) | <img src="media/caf5e11a5e0d7ed6dcc675c0caaaf7aa.png"> |  <pre>SecurityEvent<br/>\| where EventID == 4728<br/>\| where isnotempty(SubjectDomainName)<br/>\| where SubjectUserName =\~ "AutoMatedService" </pre>     \*This assumes that the Windows Security Events are collected via MMA/AMA. Hence, we are using SecurityEvent table in Azure Sentinel.  Note: Avoid case-insensitive operators (=\~) when possible for query optimization.  | [String Operators](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datatypes-string-operators#operators-on-strings)<br/>[Numerical Operators](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/numoperators)<br/>[ago](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/agofunction)<br/>[Datetime/timespan arithmetric](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/datetime-timespan-arithmetic)<br/>[between](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/betweenoperator)<br/>[now](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/nowfunction)<br/> [parse](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parseoperator)<br/>[extract](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/extractfunction)<br/>[parse_json](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsejsonfunction)<br/>[parse_csv](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsecsvfunction)<br/>[parse_path](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parsepathfunction)<br/>[parse_url](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/parseurlfunction)  |
